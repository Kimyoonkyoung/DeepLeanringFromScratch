# ConvolutionNeuralNet

***

## Convolution Layer

### fully connected 의 문제점
이미지를 처리할 때, 형상이 무시됨
* 무시되는 요소
    * 공간적으로 가까운 값이 픽셀이 비슷할 수 있음
    * RGB 각 채널은 서로 밀접하게 관련되어 있음
    * 거리가 먼 픽셀끼리는 별 연관이 없음
    * 3차원 속에서 의미를 갖는 본질적인 패턴이 숨어있음

### Convolution
fully connected 에서는 weight와 bias가 학습대상이었다면, CNN에서는 **필터를 학습함**
* 방법
    * 커널의 윈도우를 일정간격으로 이동해가면서, 입력데이터에 적용함
    * 요소끼리 곱하고 그 총합을 구함 (단일 곱셈-누산, FMA(Fused multiply-add))
    * CNN 에서 bias 는 반드시 1*1 임

### 패딩 (padding)
입력데이터 주변에 x 픽셀의 0을 채우는것
* convolution 연산을 여러번 할 경우, 패딩을 하지 않으면 크기가 조금씩 줄어드는 것이 문제가 될 수 있음

### 스트라이드 (stride)
필터를 적용하는 위치의 간격

### out layer 의 크기 계산
* out_height
    * ((height + (2 * padding) - filterHeight)) / stride + 1
* out_width
    * ((width + (2 * padding) - filterWidth)) / stride + 1
    
### 3채널에서의 convolution
* 방법
    * 각 채널마다 convolution 해서, 더한 값을 output 에 넣음
    * 반드시 입력데이터와 필터의 채널이 같아야 함
    * 모든 채널의 필터는 크기가 같아야함
* 필터를 여러개 설정하기
    * 필터는 가로 * 세로 * 입력데이터의채널수 로 구성됨
        * 각 채널의 컨볼루션 결과를 합해서 출력하기 때문에, 1채널의 output이 나옴
    * 여러개 설정이란 가로 * 세로 * 입력데이터의채널수 * 출력데이터의채널수 
        * 각각 다른 특징을 뽑아내는 필터 block 이라고 생각하면 쉬움

### pooling
세로, 가로 방향의 공간을 줄이는 연산
* 보통 풀링의 윈도우 크기와 스트라이드를 같게 함
* 특징
    * 학습할 매개변수가 없음
        * 단순히 크기만 줄이는 것
    * 채널 수가 변하지 않음
    * 입력의 변화에 영향을 적게 받음
        
### 구현 팁
im2col 이용
    * image to column 함수를 이용하여, 3차원의 이미지를 (필터적용영역 단위로)2차원으로 변형함
    * stride 설정에 따라, 겹치는 영역이 존재하여 메모리 사용량이 늘어날 수 있음
    * 필터 또한 column으로 변형하고, 행렬 곱으로 수행한 다음 reshape 으로 다시 변형해주면 됨
    
### 필터의 추출 정보
* 계층이 깊어질수록 더 추상화된 특징을 추출함
    * 1번째는 엣지, 블롭 등을 추출
    * 2번째는 텍스쳐
    * 3번째는 사물의 일부
    * 마지막은 클래스 등으로 점점 복잡하고 추상화된 정보가 추출됨
    * 단순한 모양에서 고급정보로 변화해감 (사물의 의미 파악)
    
        